#! /bin/bash

key=
in=
out=

enc_args=

for param in $@
do
    if [[ $param =~ ^-k$ ]]; then
        option=key # remember for next param
        continue
    fi

    # check previous param, if is a param name, this param should be param value
    case $option in
    key)
        enc_args="${enc_args} -k ${param}"
        option=
        ;;
    *) if [[ -z $in ]]; then
            in=$param
        elif [[ -z $out ]]; then
            out=$param
            enc_args="${enc_args} -out ${param}"
        fi
    esac
done


if [[ -z $in ]]; then
    echo "Usage: decrypt_file [-k key] crypto_file [out_file]"
    exit -1
fi

openssl aes-256-ecb -d -a -in ${in} $enc_args
